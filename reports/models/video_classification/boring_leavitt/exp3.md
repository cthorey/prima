# Best model 

- model task : video_classification 
- model name : boring_leavitt 
- data name : prima_d1_2000 
- model description : VGG16/1FRAME 
- experiment : exp3 
- model folder : /workdir/models/video_classification/boring_leavitt 
- creation time : 18/11/2017 

# Best model - training summary 

## Training set 

|     bird |   blank |     cattle |   chimpanzee |   elephant |   forest buffalo |   gorilla |   hippopotamus |    human |      hyena |   large ungulate |   leopard |       lion |   other (non-primate) |   other (primate) |   pangolin |   porcupine |   reptile |   rodent |   small antelope |   small cat |   wild dog |   duiker |      hog |
|---------:|--------:|-----------:|-------------:|-----------:|-----------------:|----------:|---------------:|---------:|-----------:|-----------------:|----------:|-----------:|----------------------:|------------------:|-----------:|------------:|----------:|---------:|-----------------:|------------:|-----------:|---------:|---------:|
| 0.177754 | 0.26281 | 0.00996853 |      0.18896 |  0.0481067 |       0.00183364 | 0.0151185 |      0.0198729 | 0.158908 | 0.00265711 |        0.0221047 | 0.0385881 | 0.00061481 |              0.166582 |          0.242976 |  0.0123668 |   0.0532967 | 0.0015538 | 0.173995 |        0.0345989 |   0.0173582 | 0.00483307 | 0.259238 | 0.186535 |

## Validation set 

|     bird |    blank |     cattle |   chimpanzee |   elephant |   forest buffalo |   gorilla |   hippopotamus |    human |     hyena |   large ungulate |   leopard |        lion |   other (non-primate) |   other (primate) |   pangolin |   porcupine |     reptile |   rodent |   small antelope |   small cat |   wild dog |   duiker |      hog |
|---------:|---------:|-----------:|-------------:|-----------:|-----------------:|----------:|---------------:|---------:|----------:|-----------------:|----------:|------------:|----------------------:|------------------:|-----------:|------------:|------------:|---------:|-----------------:|------------:|-----------:|---------:|---------:|
| 0.185739 | 0.266077 | 0.00757859 |     0.191993 |  0.0549214 |       0.00792138 | 0.0133944 |      0.0115608 | 0.153284 | 0.0022137 |         0.016718 | 0.0404134 | 8.44106e-05 |              0.186586 |          0.248194 |  0.0103765 |   0.0544261 | 0.000415729 |  0.18088 |        0.0377925 |   0.0140348 | 0.00163834 | 0.270757 | 0.194911 |

# Best model - test summary 

|     bird |    blank |    cattle |   chimpanzee |   elephant |   forest buffalo |   gorilla |   hippopotamus |    human |       hyena |   large ungulate |   leopard |        lion |   other (non-primate) |   other (primate) |   pangolin |   porcupine |     reptile |   rodent |   small antelope |   small cat |   wild dog |   duiker |      hog |
|---------:|---------:|----------:|-------------:|-----------:|-----------------:|----------:|---------------:|---------:|------------:|-----------------:|----------:|------------:|----------------------:|------------------:|-----------:|------------:|------------:|---------:|-----------------:|------------:|-----------:|---------:|---------:|
| 0.112848 | 0.205782 | 0.0163779 |     0.113884 |  0.0559282 |      0.000582007 | 0.0139264 |     0.00665502 | 0.301343 | 0.000306092 |        0.0153014 | 0.0121868 | 8.60837e-05 |             0.0912267 |          0.133697 | 0.00231622 |   0.0347847 | 0.000412832 | 0.121347 |        0.0157636 |  0.00835662 | 0.00251048 | 0.161396 | 0.107562 |



# Exepriment description 

```python 
{   'bmodel': 'VGG16',
    'callback_config': {   'cycliclr': False,
                           'keep_only_n': 5,
                           'mode': 'min',
                           'monitor': 'val_loss',
                           'patience': 35,
                           'reducelr': True,
                           'write_graph': True,
                           'write_images': False},
    'data_config': {   'base_augmentation': {   'rescale': 0.00392156862745098},
                       'batch_size': 20,
                       'mask_bcmode': None,
                       'mask_size': None,
                       'shuffle': True,
                       'target_size': <BoxList: [224, 224, 3]>,
                       'test_augmentation': {   'rescale': 0.00392156862745098},
                       'train_aug_specific': {   'fill_mode': 'nearest',
                                                 'horizontal_flip': True,
                                                 'rotation_range': 15,
                                                 'vertical_flip': True},
                       'train_augmentation': {   'fill_mode': 'nearest',
                                                 'horizontal_flip': True,
                                                 'rescale': 0.00392156862745098,
                                                 'rotation_range': 15,
                                                 'vertical_flip': True},
                       'train_batch_index': 0,
                       'train_batch_size': 20,
                       'train_directory': '/workdir/data/interim/prima_d1_500_image',
                       'train_n': 14870,
                       'train_nb_sample': 14870,
                       'train_num_classes': 24,
                       'train_shuffle': True,
                       'train_target_size': <BoxList: [224, 224, 3]>,
                       'train_total_batches_seen': 0,
                       'validation_augmentation': {   'rescale': 0.00392156862745098},
                       'validation_batch_index': 0,
                       'validation_batch_size': 20,
                       'validation_directory': '/workdir/data/interim/prima_d1_500_image',
                       'validation_n': 1659,
                       'validation_nb_sample': 1659,
                       'validation_num_classes': 24,
                       'validation_shuffle': True,
                       'validation_target_size': <BoxList: [224, 224, 3]>,
                       'validation_total_batches_seen': 0},
    'data_folder': '/workdir/data/interim/prima_d1_500_image',
    'data_name': 'prima_d1_500_image',
    'expname': 'exp3',
    'finetunning': {   'step0': {   'fit_config': {   'epochs': 50,
                                                      'steps_per_epoch': 150},
                                    'layer_name': 'head_conv_1',
                                    'training_config': {   'loss': 'binary_crossentropy',
                                                           'metrics': <BoxList: ['binary_crossentropy']>,
                                                           'model_config': {   'include_top': False,
                                                                               'input_shape': <BoxList: [224, 224, 3]>,
                                                                               'last_layer': -2,
                                                                               'mask_shape': None,
                                                                               'nb_neuron': 256,
                                                                               'num_classes': 24},
                                                           'optimizer': 'Adam',
                                                           'optimizer_config': {   'lr': 0.001}}},
                       'step1': {   'fit_config': {   'epochs': 50,
                                                      'steps_per_epoch': 150},
                                    'layer_name': 'block5_conv1',
                                    'training_config': {   'loss': 'binary_crossentropy',
                                                           'metrics': <BoxList: ['binary_crossentropy']>,
                                                           'model_config': {   'include_top': False,
                                                                               'input_shape': <BoxList: [224, 224, 3]>,
                                                                               'last_layer': -2,
                                                                               'mask_shape': None,
                                                                               'nb_neuron': 256,
                                                                               'num_classes': 24},
                                                           'optimizer': 'SGD',
                                                           'optimizer_config': {   'decay': 0.005,
                                                                                   'lr': 0.001,
                                                                                   'momentum': 0.9,
                                                                                   'nesterov': True}}},
                       'step2': {   'fit_config': {   'epochs': 50,
                                                      'steps_per_epoch': 150},
                                    'layer_name': 'block4_conv1',
                                    'training_config': {   'loss': 'binary_crossentropy',
                                                           'metrics': <BoxList: ['binary_crossentropy']>,
                                                           'model_config': {   'include_top': False,
                                                                               'input_shape': <BoxList: [224, 224, 3]>,
                                                                               'last_layer': -2,
                                                                               'mask_shape': None,
                                                                               'nb_neuron': 256,
                                                                               'num_classes': 24},
                                                           'optimizer': 'SGD',
                                                           'optimizer_config': {   'decay': 0.005,
                                                                                   'lr': 0.001,
                                                                                   'momentum': 0.9,
                                                                                   'nesterov': True}}},
                       'step3': {   'fit_config': {   'epochs': 500,
                                                      'steps_per_epoch': 150},
                                    'layer_name': 'block3_conv1',
                                    'training_config': {   'loss': 'binary_crossentropy',
                                                           'metrics': <BoxList: ['binary_crossentropy']>,
                                                           'model_config': {   'include_top': False,
                                                                               'input_shape': <BoxList: [224, 224, 3]>,
                                                                               'last_layer': -2,
                                                                               'mask_shape': None,
                                                                               'nb_neuron': 256,
                                                                               'num_classes': 24},
                                                           'optimizer': 'SGD',
                                                           'optimizer_config': {   'decay': 0.005,
                                                                                   'lr': 0.0001,
                                                                                   'momentum': 0.9,
                                                                                   'nesterov': True}}},
                       'step4': {   'fit_config': {   'epochs': 500,
                                                      'steps_per_epoch': 150},
                                    'layer_name': 'block2_conv1',
                                    'training_config': {   'loss': 'binary_crossentropy',
                                                           'metrics': <BoxList: ['binary_crossentropy']>,
                                                           'model_config': {   'include_top': False,
                                                                               'input_shape': <BoxList: [224, 224, 3]>,
                                                                               'last_layer': -2,
                                                                               'mask_shape': None,
                                                                               'nb_neuron': 256,
                                                                               'num_classes': 24},
                                                           'optimizer': 'SGD',
                                                           'optimizer_config': {   'decay': 0.005,
                                                                                   'lr': 0.0001,
                                                                                   'momentum': 0.9,
                                                                                   'nesterov': True}}}},
    'fit_config': <Box: {'steps_per_epoch': 150, 'epochs': 150}>,
    'input_shape': <BoxList: [224, 224, 3]>,
    'last_layer': 'block5_conv3',
    'model_description': 'VGG16/1FRAME',
    'model_folder': '/workdir/models/video_classification/boring_leavitt',
    'model_name': 'boring_leavitt',
    'model_task': 'video_classification',
    'stage': 'training',
    'training_config': {   'finetunning': {   'step0': {   'fit_config': {   'epochs': 50},
                                                           'layer_name': 'head_conv_1',
                                                           'training_config': {   }},
                                              'step1': {   'fit_config': {   'epochs': 50},
                                                           'layer_name': 'block5_conv1',
                                                           'training_config': {   'optimizer': 'SGD',
                                                                                  'optimizer_config': {   'decay': 0.005,
                                                                                                          'lr': 0.001,
                                                                                                          'momentum': 0.9,
                                                                                                          'nesterov': True}}},
                                              'step2': {   'fit_config': {   'epochs': 50},
                                                           'layer_name': 'block4_conv1',
                                                           'training_config': {   'optimizer': 'SGD',
                                                                                  'optimizer_config': {   'decay': 0.005,
                                                                                                          'lr': 0.001,
                                                                                                          'momentum': 0.9,
                                                                                                          'nesterov': True}}},
                                              'step3': {   'fit_config': {   'epochs': 500},
                                                           'layer_name': 'block3_conv1',
                                                           'training_config': {   'optimizer': 'SGD',
                                                                                  'optimizer_config': {   'decay': 0.005,
                                                                                                          'lr': 0.0001,
                                                                                                          'momentum': 0.9,
                                                                                                          'nesterov': True}}},
                                              'step4': {   'fit_config': {   'epochs': 500},
                                                           'layer_name': 'block2_conv1',
                                                           'training_config': {   'optimizer': 'SGD',
                                                                                  'optimizer_config': {   'decay': 0.005,
                                                                                                          'lr': 0.0001,
                                                                                                          'momentum': 0.9,
                                                                                                          'nesterov': True}}}},
                           'loss': 'binary_crossentropy',
                           'metrics': <BoxList: ['binary_crossentropy']>,
                           'model_config': {   'include_top': False,
                                               'input_shape': <BoxList: [224, 224, 3]>,
                                               'last_layer': -2,
                                               'mask_shape': None,
                                               'nb_neuron': 256,
                                               'num_classes': 24},
                           'optimizer': 'Adam',
                           'optimizer_config': <Box: {'lr': 0.001}>}}
```