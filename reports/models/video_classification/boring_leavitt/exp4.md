# Best model 

- model task : video_classification 
- model name : boring_leavitt 
- data name : prima_d1_2000 
- model description : VGG16/1FRAME 
- experiment : exp4 
- model folder : /workdir/models/video_classification/boring_leavitt 
- creation time : 18/11/2017 

# Best model - training summary 

## Training set 

|     bird |    blank |     cattle |   chimpanzee |   elephant |   forest buffalo |   gorilla |   hippopotamus |    human |      hyena |   large ungulate |   leopard |        lion |   other (non-primate) |   other (primate) |   pangolin |   porcupine |    reptile |   rodent |   small antelope |   small cat |   wild dog |   duiker |      hog |
|---------:|---------:|-----------:|-------------:|-----------:|-----------------:|----------:|---------------:|---------:|-----------:|-----------------:|----------:|------------:|----------------------:|------------------:|-----------:|------------:|-----------:|---------:|-----------------:|------------:|-----------:|---------:|---------:|
| 0.176222 | 0.264471 | 0.00902712 |     0.181186 |  0.0442163 |       0.00139283 | 0.0127134 |      0.0187183 | 0.156778 | 0.00277227 |        0.0195004 |  0.034874 | 0.000597839 |              0.161926 |          0.240167 |     0.0112 |   0.0507189 | 0.00114427 | 0.169067 |        0.0319468 |   0.0147139 | 0.00450627 | 0.259648 | 0.180501 |

## Validation set 

|     bird |    blank |     cattle |   chimpanzee |   elephant |   forest buffalo |   gorilla |   hippopotamus |    human |      hyena |   large ungulate |   leopard |        lion |   other (non-primate) |   other (primate) |   pangolin |   porcupine |     reptile |   rodent |   small antelope |   small cat |   wild dog |   duiker |      hog |
|---------:|---------:|-----------:|-------------:|-----------:|-----------------:|----------:|---------------:|---------:|-----------:|-----------------:|----------:|------------:|----------------------:|------------------:|-----------:|------------:|------------:|---------:|-----------------:|------------:|-----------:|---------:|---------:|
| 0.183185 | 0.265287 | 0.00648602 |      0.18611 |   0.052356 |       0.00658377 | 0.0078393 |      0.0131432 | 0.158671 | 0.00203892 |        0.0160181 | 0.0331895 | 5.20167e-05 |              0.187481 |           0.24708 | 0.00873818 |   0.0525226 | 0.000529624 | 0.171163 |         0.033344 |   0.0112638 | 0.00211877 |  0.26947 | 0.187579 |

# Best model - test summary 

|     bird |    blank |    cattle |   chimpanzee |   elephant |   forest buffalo |   gorilla |   hippopotamus |    human |       hyena |   large ungulate |   leopard |        lion |   other (non-primate) |   other (primate) |   pangolin |   porcupine |     reptile |   rodent |   small antelope |   small cat |   wild dog |   duiker |      hog |
|---------:|---------:|----------:|-------------:|-----------:|-----------------:|----------:|---------------:|---------:|------------:|-----------------:|----------:|------------:|----------------------:|------------------:|-----------:|------------:|------------:|---------:|-----------------:|------------:|-----------:|---------:|---------:|
| 0.105629 | 0.224444 | 0.0162682 |     0.124921 |  0.0555995 |      0.000557754 | 0.0110832 |     0.00813767 | 0.309694 | 0.000259146 |        0.0139088 | 0.0118424 | 4.98722e-05 |              0.094683 |          0.132542 | 0.00284011 |    0.035295 | 0.000434852 | 0.128855 |        0.0122266 |  0.00650549 | 0.00258759 | 0.158171 | 0.111095 |



# Exepriment description 

```python 
{   'bmodel': 'VGG16',
    'callback_config': {   'cycliclr': False,
                           'keep_only_n': 5,
                           'mode': 'min',
                           'monitor': 'val_loss',
                           'patience': 35,
                           'reducelr': True,
                           'write_graph': True,
                           'write_images': False},
    'data_config': {   'base_augmentation': {   'rescale': 0.00392156862745098},
                       'batch_size': 20,
                       'mask_bcmode': None,
                       'mask_size': None,
                       'shuffle': True,
                       'target_size': <BoxList: [224, 224, 3]>,
                       'test_augmentation': {   'rescale': 0.00392156862745098},
                       'train_aug_specific': {   'fill_mode': 'nearest',
                                                 'horizontal_flip': True,
                                                 'rotation_range': 15,
                                                 'vertical_flip': True},
                       'train_augmentation': {   'fill_mode': 'nearest',
                                                 'horizontal_flip': True,
                                                 'rescale': 0.00392156862745098,
                                                 'rotation_range': 15,
                                                 'vertical_flip': True},
                       'train_batch_index': 0,
                       'train_batch_size': 20,
                       'train_directory': '/workdir/data/interim/prima_d1_500_image',
                       'train_n': 14870,
                       'train_nb_sample': 14870,
                       'train_num_classes': 24,
                       'train_shuffle': True,
                       'train_target_size': <BoxList: [224, 224, 3]>,
                       'train_total_batches_seen': 0,
                       'validation_augmentation': {   'rescale': 0.00392156862745098},
                       'validation_batch_index': 0,
                       'validation_batch_size': 20,
                       'validation_directory': '/workdir/data/interim/prima_d1_500_image',
                       'validation_n': 1659,
                       'validation_nb_sample': 1659,
                       'validation_num_classes': 24,
                       'validation_shuffle': True,
                       'validation_target_size': <BoxList: [224, 224, 3]>,
                       'validation_total_batches_seen': 0},
    'data_folder': '/workdir/data/interim/prima_d1_500_image',
    'data_name': 'prima_d1_500_image',
    'expname': 'exp4',
    'finetunning': {   'step0': {   'fit_config': {   'epochs': 50,
                                                      'steps_per_epoch': 150},
                                    'layer_name': 'head_conv_1',
                                    'training_config': {   'loss': 'binary_crossentropy',
                                                           'metrics': <BoxList: ['binary_crossentropy']>,
                                                           'model_config': {   'include_top': False,
                                                                               'input_shape': <BoxList: [224, 224, 3]>,
                                                                               'last_layer': -2,
                                                                               'mask_shape': None,
                                                                               'nb_neuron': 512,
                                                                               'num_classes': 24},
                                                           'optimizer': 'Adam',
                                                           'optimizer_config': {   'lr': 0.001}}},
                       'step1': {   'fit_config': {   'epochs': 50,
                                                      'steps_per_epoch': 150},
                                    'layer_name': 'block5_conv1',
                                    'training_config': {   'loss': 'binary_crossentropy',
                                                           'metrics': <BoxList: ['binary_crossentropy']>,
                                                           'model_config': {   'include_top': False,
                                                                               'input_shape': <BoxList: [224, 224, 3]>,
                                                                               'last_layer': -2,
                                                                               'mask_shape': None,
                                                                               'nb_neuron': 512,
                                                                               'num_classes': 24},
                                                           'optimizer': 'SGD',
                                                           'optimizer_config': {   'decay': 0.005,
                                                                                   'lr': 0.001,
                                                                                   'momentum': 0.9,
                                                                                   'nesterov': True}}},
                       'step2': {   'fit_config': {   'epochs': 50,
                                                      'steps_per_epoch': 150},
                                    'layer_name': 'block4_conv1',
                                    'training_config': {   'loss': 'binary_crossentropy',
                                                           'metrics': <BoxList: ['binary_crossentropy']>,
                                                           'model_config': {   'include_top': False,
                                                                               'input_shape': <BoxList: [224, 224, 3]>,
                                                                               'last_layer': -2,
                                                                               'mask_shape': None,
                                                                               'nb_neuron': 512,
                                                                               'num_classes': 24},
                                                           'optimizer': 'SGD',
                                                           'optimizer_config': {   'decay': 0.005,
                                                                                   'lr': 0.001,
                                                                                   'momentum': 0.9,
                                                                                   'nesterov': True}}},
                       'step3': {   'fit_config': {   'epochs': 500,
                                                      'steps_per_epoch': 150},
                                    'layer_name': 'block3_conv1',
                                    'training_config': {   'loss': 'binary_crossentropy',
                                                           'metrics': <BoxList: ['binary_crossentropy']>,
                                                           'model_config': {   'include_top': False,
                                                                               'input_shape': <BoxList: [224, 224, 3]>,
                                                                               'last_layer': -2,
                                                                               'mask_shape': None,
                                                                               'nb_neuron': 512,
                                                                               'num_classes': 24},
                                                           'optimizer': 'SGD',
                                                           'optimizer_config': {   'decay': 0.005,
                                                                                   'lr': 0.0001,
                                                                                   'momentum': 0.9,
                                                                                   'nesterov': True}}},
                       'step4': {   'fit_config': {   'epochs': 500,
                                                      'steps_per_epoch': 150},
                                    'layer_name': 'block2_conv1',
                                    'training_config': {   'loss': 'binary_crossentropy',
                                                           'metrics': <BoxList: ['binary_crossentropy']>,
                                                           'model_config': {   'include_top': False,
                                                                               'input_shape': <BoxList: [224, 224, 3]>,
                                                                               'last_layer': -2,
                                                                               'mask_shape': None,
                                                                               'nb_neuron': 512,
                                                                               'num_classes': 24},
                                                           'optimizer': 'SGD',
                                                           'optimizer_config': {   'decay': 0.005,
                                                                                   'lr': 0.0001,
                                                                                   'momentum': 0.9,
                                                                                   'nesterov': True}}}},
    'fit_config': <Box: {'steps_per_epoch': 150, 'epochs': 150}>,
    'input_shape': <BoxList: [224, 224, 3]>,
    'last_layer': 'block5_conv3',
    'model_description': 'VGG16/1FRAME',
    'model_folder': '/workdir/models/video_classification/boring_leavitt',
    'model_name': 'boring_leavitt',
    'model_task': 'video_classification',
    'stage': 'training',
    'training_config': {   'finetunning': {   'step0': {   'fit_config': {   'epochs': 50},
                                                           'layer_name': 'head_conv_1',
                                                           'training_config': {   }},
                                              'step1': {   'fit_config': {   'epochs': 50},
                                                           'layer_name': 'block5_conv1',
                                                           'training_config': {   'optimizer': 'SGD',
                                                                                  'optimizer_config': {   'decay': 0.005,
                                                                                                          'lr': 0.001,
                                                                                                          'momentum': 0.9,
                                                                                                          'nesterov': True}}},
                                              'step2': {   'fit_config': {   'epochs': 50},
                                                           'layer_name': 'block4_conv1',
                                                           'training_config': {   'optimizer': 'SGD',
                                                                                  'optimizer_config': {   'decay': 0.005,
                                                                                                          'lr': 0.001,
                                                                                                          'momentum': 0.9,
                                                                                                          'nesterov': True}}},
                                              'step3': {   'fit_config': {   'epochs': 500},
                                                           'layer_name': 'block3_conv1',
                                                           'training_config': {   'optimizer': 'SGD',
                                                                                  'optimizer_config': {   'decay': 0.005,
                                                                                                          'lr': 0.0001,
                                                                                                          'momentum': 0.9,
                                                                                                          'nesterov': True}}},
                                              'step4': {   'fit_config': {   'epochs': 500},
                                                           'layer_name': 'block2_conv1',
                                                           'training_config': {   'optimizer': 'SGD',
                                                                                  'optimizer_config': {   'decay': 0.005,
                                                                                                          'lr': 0.0001,
                                                                                                          'momentum': 0.9,
                                                                                                          'nesterov': True}}}},
                           'loss': 'binary_crossentropy',
                           'metrics': <BoxList: ['binary_crossentropy']>,
                           'model_config': {   'include_top': False,
                                               'input_shape': <BoxList: [224, 224, 3]>,
                                               'last_layer': -2,
                                               'mask_shape': None,
                                               'nb_neuron': 512,
                                               'num_classes': 24},
                           'optimizer': 'Adam',
                           'optimizer_config': <Box: {'lr': 0.001}>}}
```